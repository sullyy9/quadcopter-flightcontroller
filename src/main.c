/*----------------------------------------------------------------------------*/
/*
    Ryan Sullivan

    Module Name     :   main.c
    Description     :   main program
*/
/*----------------------------------------------------------------------------*/

#include <stdbool.h>
#include <stdint.h>

#include "main.h"
#include "io.h"
#include "utils.h"
#include "commonio.h"
#include "comms.h"
#include "port.h"

/*----------------------------------------------------------------------------*/
/*-constant-definitions-------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*-exported-variables---------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*-static-variables-----------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*-forward-declarations-------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*-exported-functions---------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

int main( void )
{

    io_initialise( );

    commonio_clear_reset_flags( );

    utils_wait_ms( 3000 );

    io_toggle_w_led( );

    comms_usart1_tx_byte( 'h' );
    comms_usart1_tx_byte( 'e' );
    comms_usart1_tx_byte( 'l' );
    comms_usart1_tx_byte( 'l' );
    comms_usart1_tx_byte( 'o' );
    comms_usart1_tx_byte( '\r' );
    comms_usart1_tx_byte( '\n' );

    utils_wait_ms( 1000 );

    while( 1 );

    return( 0 );
}

/*----------------------------------------------------------------------------*/

void main_1ms_timer_isr( void )
{
    io_1ms_poll( );
    utils_1ms_poll( );
}

/*----------------------------------------------------------------------------*/
/*-static-functions-----------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*-end-of-module--------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/
